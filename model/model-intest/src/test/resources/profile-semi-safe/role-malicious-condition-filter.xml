<!--
  ~ Copyright (C) 2010-2025 Evolveum and contributors
  ~
  ~ Licensed under the EUPL-1.2 or later.
  -->

<role xmlns="http://midpoint.evolveum.com/xml/ns/public/common/common-3"
        xmlns:q="http://prism.evolveum.com/xml/ns/public/query-3"
        oid="47c3c21a-b336-11f0-afd8-8f70911233b3">
    <name>Malicious Condition Filter Role</name>
    <documentation>
        Role that tries to execute Groovy code in role condition, inside a filter.
    </documentation>
    <inducement>
        <!-- Harmless role -->
        <targetRef oid="15f860d0-b32a-11f0-b169-431d2df5bf12" type="RoleType"/>
    </inducement>
    <condition>
        <expression>
            <filter>
                <filter>
                    <q:text>costCenter = `com.evolveum.midpoint.model.intest.TestExpressionProfileSemiSafe.boom()`</q:text>
                </filter>
            </filter>
        </expression>
    </condition>
</role>
