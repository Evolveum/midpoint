<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<!--
  ~ Copyright (c) 2025 Evolveum and contributors
  ~
  ~ Licensed under the EUPL-1.2 or later.
  -->


<systemConfiguration oid="00000000-0000-0000-0000-000000000001"
        xmlns="http://midpoint.evolveum.com/xml/ns/public/common/common-3">
    <name>SystemConfiguration</name>
    <defaultObjectPolicyConfiguration>
        <type>UserType</type>
        <expressionProfile>prohibitive</expressionProfile>
    </defaultObjectPolicyConfiguration>
    <defaultObjectPolicyConfiguration>
        <type>RoleType</type>
        <expressionProfile>safe</expressionProfile>
    </defaultObjectPolicyConfiguration>
    <defaultObjectPolicyConfiguration>
        <type>OrgType</type>
        <expressionProfile>safe</expressionProfile>
    </defaultObjectPolicyConfiguration>
    <defaultObjectPolicyConfiguration>
        <type>ServiceType</type>
        <expressionProfile>safe</expressionProfile>
    </defaultObjectPolicyConfiguration>
    <defaultObjectPolicyConfiguration>
        <type>ReportType</type>
        <expressionProfile>safe</expressionProfile>
    </defaultObjectPolicyConfiguration>
    <roleManagement>
        <autoassignEnabled>true</autoassignEnabled>
    </roleManagement>
    <expressions>
        <expressionProfile id="218">
            <identifier>safe</identifier>
            <description>
                "Safe" expression profile. It is supposed to contain only operations that are "safe",
                i.e. operations that have very little risk to harm the system, circumvent midPoint security
                and so on. Use of those operations should be reasonably safe in all expressions.
                However, there are limitations. This profile may incomplete or it may even be not completely secure.
                Proper security testing of this profile was not yet conducted. It is provided here "AS IS",
                without any guarantees. Use at your own risk.
            </description>
            <decision>deny</decision> <!-- default decision of those evaluators that are not explicitly enumerated. -->
            <evaluator id="219">
                <type>asIs</type>
                <decision>allow</decision>
            </evaluator>
            <evaluator id="220">
                <type>path</type>
                <decision>allow</decision>
            </evaluator>
            <evaluator id="221">
                <type>value</type>
                <decision>allow</decision>
            </evaluator>
            <evaluator id="222">
                <type>const</type>
                <decision>allow</decision>
            </evaluator>
            <evaluator id="273">
                <type>filter</type>
                <decision>allow</decision>
            </evaluator>
            <evaluator id="274">
                <type>function</type>
                <decision>allow</decision>
            </evaluator>
            <evaluator id="278">
                <type>generate</type>
                <decision>allow</decision>
            </evaluator>
            <evaluator id="279">
                <type>proportional</type>
                <decision>allow</decision>
            </evaluator>
            <bulkActionsProfile>prohibitive</bulkActionsProfile>
            <privilegeElevation>deny</privilegeElevation>
        </expressionProfile>
        <expressionProfile id="275">
            <identifier>permissive</identifier>
            <description>Unlimited access to all expressions</description>
            <decision>allow</decision>
            <privilegeElevation>allow</privilegeElevation>
        </expressionProfile>
        <expressionProfile id="276">
            <identifier>prohibitive</identifier>
            <description>No access to any expressions</description>
            <decision>deny</decision>
            <bulkActionsProfile>prohibitive</bulkActionsProfile>
            <privilegeElevation>deny</privilegeElevation>
        </expressionProfile>
        <bulkActionsProfile id="277">
            <identifier>prohibitive</identifier>
            <decision>deny</decision>
        </bulkActionsProfile>
    </expressions>
</systemConfiguration>
