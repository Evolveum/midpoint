= Resource wizard: Object type correlation
:page-nav-title: Correlation
:page-toc: top
:page-since: "4.9"
:experimental:

Smart correlation in midPoint is a mechanism that links resource object shadows to existing focal objects, enabling efficient synchronization through a configurable matching system.
In short, it's a means of searching for resource object owners in midPoint.

Correlation rules dictate how to find the object owners.
You can define one or more correlation rules.

image::corerlation-rules-setup-accounts-configure-menu.webp[title="Configuration menu in resource accounts list as an entry point to the correlation rules wizard"]

== Create Correlation Rules

. In icon:database[] *Resources* > icon:database[] *All Resources*, select your resource.
. In icon:male[] *Accounts*, click icon:cog[] btn:[Configure] > icon:code-branch[] *Correlation*.
. Click icon:plus-circle[] btn:[Add rule] and configure the new rule:
    ** *Rule name*: A descriptive name of the rule. Needs to be unique in the context of the resource.
    ** *Description*: An optional detailed description of the rule.
    ** *Weight*: The weight is multiplied by correlator confidence to get the rule confidence value.
    ** *Tier*: Tiers dictate the order of rule processing. If and only if the rule doesn't provide confident-enough match, next tier is processed
    ** *Ignore if matched by*:
    ** *Enabled*: An option to temporarily disable a rule. _Undefined_ is the same as _Enabled_.
. Click icon:plus-circle[] btn:[Add rule] and repeat until you add all the rules.
. Click icon:check[] btn:[Save correlation settings] to save the rules and exit the wizard.

image::corerlation-rules-list.webp[title="List of configured correlation rules"]

=== Set up Correlators

For each correlation rule, you need to also add a *correlator*.
Correlators specify which attributes to compare when matching resource and focal objects.
These attributes need to be unique and common to both the midPoint focal objects and the resource objects.

To add correlators for correlation rules:

. Open the list of correlation rules from your resource accounts list via icon:cog[] btn:[Configure] > icon:code-branch[] *Correlation*.
. In the list, click icon:edit[] btn:[Edit] at the far right of a correlation rule row you're going to configure the correlator for.
. Click icon:plus-circle[] btn:[Add correlator].
. Under *Item*, select the attribute to correlate (i.e., _compare_ or _match_).
. Select the *Search method*:
	** _Exact match_: The attribute values need to match exactly for the objects to correlate or get linked, in other words.
	** _Levenshtein distance_: Method of approximate matching with a threshold of the minimum number of single-character edits. Refer to link:https://en.wikipedia.org/wiki/Levenshtein_distance[Levenshtein distance on Wikipedia] for more details about the method.
	** _Trigram similarity_: Method of approximate matching using the ratio of common trigrams to all trigrams in compared strings.
. For the fuzzy-search methods, define *Match threshold* and whether the value is *Inclusive* (in the mathematical sense).
. Click icon:check[] btn:[Confirm settings] to save the correlators and return to the correlation rule list.

image::corerlation-rules-correlator.webp[title="List of correlators for one correlation rule"]

// TODO: the rest of the article is yet to be taken care of

Click btn:[Edit] button to edit details of the correlation rule.

Specify the item configuration:

* *Item* refers to a midPoint property for which an inbound mapping exists. This will be used for correlation. E.g. if there is an inbound mapping from AD's `sAMAccountName` attribute to midPoint user's `name` property, you would use `name` item
+
TIP: For target resources where inbound mappings are normally not used, the inbound mapping can be in a special <<#use_inbound_for_correlation,"Use for correlation only" mode>>.
* *Search method* allows to specify either exact match or one of the fuzzy search methods supported by midPoint


.Table of correlation items for one correlation rule
image::step-4-correlator-item.png[link=step-4-correlator-item.png,100%,title=Table of correlation items for one correlation rule]

.See also the following pages for more information:
* xref:/midpoint/reference/correlation/items-correlator/[]
* xref:/midpoint/reference/correlation/[Smart Correlation]

Click btn:[Save correlation settings] when done to return to the previous page from which you started the correlation editor.

include::../../configuration-resource-panels.adoc[]

include::../../how-to-use-lifecycle-state.adoc[]

include::../../limitation-corelation.adoc[]
