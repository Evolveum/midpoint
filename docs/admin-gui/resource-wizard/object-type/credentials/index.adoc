// = Resource wizard: Object type credentials
= Manage credential mappings in GUI
:page-nav-title: Credentials
:page-toc: top
:experimental:
:page-since: "4.9"

Manage credentials on your resources in the graphical user interface using the resource wizard for credential mappings.

In midPoint, you can manage various types of credentials, such as passwords, link:https://en.wikipedia.org/wiki/Secure_Shell#Authentication:_OpenSSH_key_management[SSH keys], link:https://en.wikipedia.org/wiki/X.509[X.509] certificates for link:https://en.wikipedia.org/wiki/Transport_Layer_Security[TLS], link:https://en.wikipedia.org/wiki/Time-based_one-time_password[TOTPs] for link:https://en.wikipedia.org/wiki/Multi-factor_authentication[MFA], etc.
You can configure credential mappings to transfer credentials between the resource and midPoint, generate new keys that follow your security policies, or run a script to perform any advanced actions on the credentials.

The resource wizard for credential mappings is similar to the xref:/midpoint/reference/admin-gui/resource-wizard/object-type/activation/[wizard used for activation configuration].
However, it is generally simpler and does not offer any presets.

[NOTE]
====
You do not need any credential mappings if you do not manage credentials on the resource.
That may be, for instance, when you handle authentication by SSO using a separate system.
====

.Configuration menu in the resource account list as an entry point to the credential mapping rules wizard
image::credential-mapping-setup-accounts-configure-menu.webp["Configuration menu in the resource account list as an entry point to the credential mapping rules wizard"]

== Add credential mappings

To define credential mappings in the GUI:

. In [.nowrap]#icon:database[] *Resources*# > [.nowrap]#icon:database[] *All resources*#, go to your resource.
. In [.nowrap]#icon:male[] *Accounts*#, click [.nowrap]#icon:cog[] btn:[Configure]# > [.nowrap]#icon:key[] *Credentials*#.
. Select [.nowrap]#icon:arrow-right-to-bracket[] *Inbound*# or [.nowrap]#icon:arrow-right-from-bracket[] *Outbound*# tab:
    ** Inbound: To send credentials to midPoint
    ** Outbound: To send credentials to the resource
. Click [.nowrap]#icon:circle-plus[] btn:[Add inbound]# (or outbound) to add new mapping rule.
. Click [.nowrap]#icon:gear[] btn:[Settings]# on the new tile that appears in the selected tab.

.Outbound credential mappings overview
image::credential-outbound-mapping.webp["Outbound credential mappings overview with one active mapping to generate initial password"]

=== Define basic options

At this point, what you do next highly depends on what your goal is.
Here is an outline of your options:

* *Name* the mapping descriptively.
    ** The requirements are identical to those for other mappings:
        In general, it is optimal to treat mapping names the same as file names.
        They need to be unique and it is best to use hyphens instead of spaces.
* Set *strength* based on the mapping purpose. See the xref:/midpoint/reference/admin-gui/resource-wizard/object-type/mapping/advanced-mappings/#mapping-strength[explanation of the mapping strength options].
* In *Expression*, you define how to handle the credential.
    ** _As is_ is the simplest option that just passes an existing value from midPoint to the resource or vice versa.
    ** _Generate_ tells midPoint to create a new random password.
        This is typically used with the _weak_ strength for initial passwords.
    ** _Literal_ inserts a static value.
    ** _Script_ gives you the option to manipulate the value on your own terms.
* See the section on xref:#credentials-source-and-target[source and target options] below to decide whether you need to adjust them.
// TODO: Find out some use case for scripts in credential mappings @dakle 2025-11-10

When you are done with the basic setup, click btn:[Next: Optional].

[[credentials-source-and-target]]
=== Source and target mapping options

In some cases, you may also need to specify the source and target options for the mapping.

As a general rule, define source and target in credential mappings only when the connector does not implicitly handle credentials on its own.
Otherwise, rely on the connector's default behavior and leave the source and target options blank.
When you use a resource like LDAP, the connector knows where the credentials belong.
Similarly, midPoint knows implicitly where to store credentials.

However, in case you exchange passwords with a custom resource or with something like a xref:/connectors/connectors/com.evolveum.polygon.connector.csv.CsvConnector/[CSV file],
you need to tell midPoint (and, by extension, the connector) which column holds the credentials.

* For [.nowrap]#icon:arrow-right-to-bracket[] *Inbound*# mappings:
    ** *Source* specifies the attribute on the resource side from which to take the credentials.
        For example, the value to use in case of a CSV resource may be `$shadow/attributes/ri:someColumnName`.
    ** *Target* specifies the attribute of the resource object type in midPoint to which you wish to put the credential, e.g. `credentials/password`.
        The use case for this option is when you have a special object type attribute for the password or other credential.
        For example, to copy an authentication token to a custom object type attribute.
    ** You do not have to explicitly specify _both_ source and target, if not required.
* For [.nowrap]#icon:arrow-right-from-bracket[] *Outbound*# mappings:
    ** You can only define *source* and it is exactly that attribute you would define as *target* for inbound mappings (e.g., a custom object type attribute for authentication tokens).
    ** If you need to specify a target in the case of a CSV resource, for example, you need to map the appropriate column in the general outbound xref:/midpoint/reference/admin-gui/resource-wizard/object-type/mapping/[mapping rules].
        For example, were you to copy midPoint user (focus) password to a `someColumnName` column in the CSV, you would use `credentials/password` as the source and `someColumnName` as the target.

=== Adjust advanced settings

On the screen that follows, define the parameters below as needed.
You can safely leave them at defaults and click [.nowrap]#icon:check[] btn:[Done]# to save the mapping and exit the wizard.

* *Authoritative* option defines whether the mapping "tolerates" changes by other means.
    ** Refer to xref:/midpoint/reference/expressions/mappings/#authoritative[Mappings (authoritative)] for details.
* *Exclusive* option ensures only one mapping can target the particular attribute.
    ** Refer to xref:/midpoint/reference/expressions/mappings/#exclusive[Mappings (exclusive)] for details.
* *Channel* option provides a way to restrict the mapping applicability only to the context of certain channels.
    ** Refer to xref:/midpoint/reference/expressions/mappings/#channel-constraints[Mappings (channel constraints)] for details.

When you are done with the setup, click [.nowrap]#icon:check[] btn:[Done]#.

[TIP]
====
New credential mappings are in the _Active_ lifecycle state by default.
We suggest you change it to _Proposed_ and xref:/midpoint/reference/admin-gui/resource-wizard/wizard-existing-resource/#simulated-tasks[test your configuration] first.
====

== Example configurations

Here are a few example configurations you can use as starting points for your configuration.

=== Generate initial password

Let us have a target resource to which you provision accounts as they are creates in a source resource.
Some systems, such as LDAP, do not allow _passwordless_ accounts, meaning you have to create _some_ password,
even if users need to reset it by means of a help desk, for instance, before actually using the account.

This is the situation to have midPoint generate a random password for new accounts.

. Create a new *outbound* credential mapping.
. *Name* it _generate-initial-password_, for instance.
. Give it a _weak_ *strength*.
. Set the *expression* option to _Generate_.
. Save the mapping.

This mapping populates the password attribute with a random generated password only if the attribute is empty.
Under all other circumstances, the mapping does not change the password because you set it as _weak_.

=== Let users change their password from midPoint

To let users change their resource password in midPoint,
add an outbound credential mapping that takes the password from the corresponding focus in midPoint
and updates it in the resource shadow (and the remote resource, by extension) during reconciliation.
Additionally, you may want to prevent midPoint from overwriting the password, should the user change it by other means—e.g., directly on the resource.

. Create a new *outbound* credential mapping.
. *Name* it _change-password_, for instance.
. Give it a _normal_ *strength*.
. Set the *expression* to _As is_.
. Save the mapping.

The strength of this mapping dictates that it updates the target value when the source changes,
but leaves it be in case the source stays the same but the target value is updated to other value.
The _As is_ expression simply copies the password from midPoint to the resource.

include::../../limitation-all.adoc[]

include::../../see-also.adoc[]

* xref:/midpoint/reference/security/credentials/[]

* xref:/midpoint/reference/expressions/[]

* xref:/midpoint/reference/simulation/[]
