<!--
  ~ Copyright (C) 2010-2021 Evolveum and contributors
  ~
  ~ Licensed under the EUPL-1.2 or later.
  -->

<role xmlns="http://midpoint.evolveum.com/xml/ns/public/common/common-3"
        xmlns:ext="http://midpoint.evolveum.com/xml/ns/test/system-perf"
        oid="7c359aa0-d798-4781-a58b-d6336cb9b1ee">
    <name>metarole-technical</name>

    <inducement>
        <focusMappings>
            <mapping>
                <name>focus mapping memberOf</name>
                <authoritative>true</authoritative>
                <strength>strong</strength>
                <expression>
                    <script>
                        <code>
                            'R:' + assignmentPath[0].target.name + '-' + assignmentPath[1].target.name
                        </code>
                    </script>
                </expression>
                <target>
                    <path>$user/c:extension/ext:memberOf</path>
                    <set>
                        <condition>
                            <script>
                                <code>
                                    input?.startsWith("R:")
                                </code>
                            </script>
                        </condition>
                    </set>
                </target>
            </mapping>
        </focusMappings>
        <order>2</order>
    </inducement>
</role>
